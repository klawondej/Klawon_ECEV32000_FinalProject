# Klawon_ECEV32000_FinalProject

# Background:
# Aire is a transcription factor highly and specificly expressed in medulary epithelial cells in the thymus.  It is known to drive transcription of tissue-specific antigen loci that would otherwise not be expressed in the thymus, such as the retina-associated protein IRBP and the prostate-specific calcium channel Tcaf3.  As the thymus is the site of T cell development, it follows that Aire plays a role in preventing the development of autoimmune diseases; a process known as central tolerance.  Indeed, patients lacking functional Aire develop a host of autoimmune diseases and require lifelong immunosuppressive therapy.
# One model of central tolerance, refered to as clonal deletion, proposes that dangerous, self-reactive T cell clones developing in the thymus encounter self antigen and are deleted before maturing and taking residence in the periphery.  Historic work surrounding Aire has led to a model whereby Aire expresses tissue-restricted antigens as a way to expose T cell clones to diverse, rare antigens for more complete clonal deletion.  My lab recently identified a role for Aire in promoting self-reactive clones to develop into Tregs, a cell subset with an inherently quiescent phenotype.

# Rationale:
# We have thus taken an approach to study Aire-dependent Treg cells at the clonal rather than bulk population level.  To identify potential clones of interest, we use a modern technique called iRepertoire sequencing, which is able to identify the clonal diversity within a given T cell pool.  As such, we have gathered repertoire data from multiple organs of Aire-sufficicent and deficient mice.  We currently attempt to identify recurrent clones in a repertoire by a simple sort of the highest-frequency clones in the raw data, and then cross-referencing by eye the top clones to other biological replicates.
# This presents two problems.  First, each raw-data repertoire consists of clones that appear to be separate based on the CDR3 region, but in reality share the same TCR-alpha and beta chains and have highly similar CDR3s, suggesting that these are likely related clones reactive to the same epitopes.  Following, there is no mechanism by which to quantify the 'corrected' frequency of related T cell clones between biological replicates to determine exactly how prevelent related clones are between these samples.

# Project Description:
# Here, I've written a Python script to do the bulk of the correction and cross-reference analysis, and a short R script to create a visual plot for asthetic qualification of the data.  At it's core, the Python script reads the raw file for an individual repertoire, splits the data into the top 10 most prevalent clones and the rest (ie. 11 - end), then runs a Levenstein Distance similarity function on the CDR3 of clones with the same TCR-alpha and beta sequences to concatinate all frequencies of similar TCRs into the matching clone in the top 10.  This script performs this analysis on all biological replicates as separate repertoires, then further compiles similar TCR clones between the mice to create a master .csv file containing the top clones among all repertoires, and how often identical or similar clones appear between repertoires.  The R script puts this master .csv file into a graph depicting the CDR3 clones (x-axis), their frequency in different repertoires (y-axis), and how many repertoires they identically or similarly appear (size).

# Instructions:
# To run the Python file (Project_Part_1), simply place the individual repertoire data (named Mouse_##, 6 files total) into the same directory as your python working directory, and specify the root path at the beginning (ie. mypath = '') and near the bottom after the repeating '#####' (ie. mynewpath = '').  Do the same path specification with the R file (Project_Part_2) (ie. my.data <- read.csv(file = 'c://.../Top_TCRs_Compiled_All_Mice.csv), and run this script after the Python script is completed.

# Thanks for a great class Stefano - though I am still very much an ameteur, I feel comfortable reading scripts and writing some basic scripts.
# I'd also like to acknowledge Julian Lutze from the class, who gave some great advice to help write this script and make it more efficicent.
